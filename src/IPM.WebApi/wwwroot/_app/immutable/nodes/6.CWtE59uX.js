import{a as d,t as $,b}from"../chunks/disclose-version.Bh5S6th3.js";import{$ as L,W as l,a1 as z,a0 as F,X as _,Z as u,_ as n,Y as f,R as U,P as k,V as x}from"../chunks/runtime.lGjdO0kn.js";import{e as j,s as D}from"../chunks/render.CqSVrQGm.js";import{i as H}from"../chunks/if.D-X0sUps.js";import{c as W}from"../chunks/css-props.Dz4kt93Y.js";import{p as q}from"../chunks/props.BcrW9nJw.js";import{g as B}from"../chunks/entry.DelLnDt6.js";import{z as g,a as C,H as I,P as A,b as J,L as Q}from"../chunks/PrimaryTextField.aD2W7olh.js";import{s as R}from"../chunks/jwtService.BpeZ_aWj.js";import{s as V,d as X}from"../chunks/userInfo.svelte.BrpyVLMO.js";import{t as Y}from"../chunks/Toaster.svelte_svelte_type_style_lang.Djr9A2tR.js";const Z=g.object({email:g.string().email({message:"Định dạng email chưa đúng"}),password:g.string()});async function G(m){try{let s=Z.parse(m);const a=await C.post("login",{json:{email:s.email,password:s.password},credentials:"include"}).json();return V(X(a.accessToken)),R(a.accessToken),{isSuccess:!0,error:null}}catch(s){return s instanceof I&&s.response.status==401?{isSuccess:!1,error:"Unauthorized"}:{isSuccess:!1,error:s}}}var K=$('<h1 class="svelte-11mappv">Welcome Back</h1> <form class="svelte-11mappv"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!> <a class="forgot-password svelte-11mappv" href="/">Quên mật khẩu</a> <div class="error svelte-11mappv"><!></div> <!></form> <p class="register svelte-11mappv">Chưa có tài khoản? <a href="/register" class="svelte-11mappv">Đăng kí</a></p>',1);function ls(m,s){L(s,!0);let a=x(!1),t=x(null);async function y(e){e.preventDefault(),n(a,!0);const r=new FormData(e.target),o=await G({email:r.get("email"),password:r.get("password")});if(n(a,!1),o.isSuccess)Y.success("Đăng nhập thành công"),B("/dashboard");else if(o.error==="Unauthorized")n(t,"Email hoặc mật khẩu không chính xác");else{let S=o.error;n(t,q(S.issues[0].message))}}function v(){n(t,null)}var h=K(),c=l(z(h),2),i=_(c);W(i,()=>({"--margin-bottom":"1.5em"})),A(i.lastChild,{id:"email",placeHolder:"anh@gmail.com",label:"Email",type:"email",name:"email",onfocus:v,required:!0}),f(i);var w=l(i,2);J(w,{id:"password",label:"Password",name:"password",onfocus:v,required:!0});var p=l(w,4),P=_(p);{var T=e=>{var r=b();U(()=>D(r,u(t))),d(e,r)};H(P,e=>{u(t)!=null&&e(T)})}f(p);var E=l(p,2);Q(E,{get isLoading(){return u(a)},type:"submit",children:(e,r)=>{k();var o=b("Đăng nhập");d(e,o)},$$slots:{default:!0}}),f(c),k(2),j("submit",c,y),d(m,h),F()}export{ls as component};
