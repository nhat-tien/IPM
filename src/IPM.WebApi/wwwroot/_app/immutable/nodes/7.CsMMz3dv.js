import"../chunks/disclose-version.Bg9kRutz.js";import{a4 as A,Q as k,V as l,W as u,X as o,Y as v,a2 as Q,a3 as R,T as L,Z as N,P as F}from"../chunks/runtime.2TQkkbdU.js";import{d as U,s as P,e as W}from"../chunks/render.CUPvWneb.js";import{i as M}from"../chunks/if.7ZJsWVon.js";import{c as D}from"../chunks/css-props.BPPcTq2y.js";import{a as h,t as H,b as q}from"../chunks/template.CAbfWL_E.js";import{a as Y,p as Z}from"../chunks/props.BH3iTQOK.js";import{g as G}from"../chunks/entry.DQpy8rRy.js";import{z as p,a as J,H as K,P as E}from"../chunks/PrimaryTextField.t_Uysw41.js";import{P as z,L as O}from"../chunks/PasswordTextField.lcDNlKNj.js";import{e as $,i as ee}from"../chunks/each.CNIUeDGL.js";import{s as V}from"../chunks/attributes.CxDnN36E.js";import{t as ae}from"../chunks/Toaster.svelte_svelte_type_style_lang.Ca3an25N.js";const se=p.object({roleId:p.enum(["1","2","3"],{message:"Xin hãy chọn vai trò"}),email:p.string().email({message:"Định dạng email chưa đúng"}),lastName:p.string().min(1,{message:"Họ lót không được trống"}).max(50,{message:"Họ lót không vượt quá 50 kí tự"}),firstName:p.string().min(1,{message:"Tên không được trống"}).max(15,{message:"Tên không vượt quá 15 kí tự"}),password:p.string().min(6,{message:"password tối thiểu 6 và tối đa 20 kí tự"}).max(20,{message:"password tối thiểu 6 và tối đa 20 kí tự"}),confirmPassword:p.string()}).refine(({password:n,confirmPassword:e})=>n===e,{message:"Nhập lại mật khẩu chưa chính xác"});async function te(n){try{let e=se.parse(n);return(await J.post("register",{json:{lastName:e.lastName,firstName:e.firstName,email:e.email,password:e.password,roleId:e.roleId},credentials:"include"}).json()).isSuccess?{isSuccess:!0,error:null}:{isSuccess:!1,error:null}}catch(e){return e instanceof K&&console.log(await e.response.json()),{isSuccess:!1,error:e}}}function re(n,e){e(n.currentTarget.value)}var le=H("<label> </label>"),oe=H("<option> </option>"),ne=H('<!> <select class="svelte-1088339"><option disabled selected hidden> </option><!></select>',1);function ie(n,e){let _=Y(e,"value",15,"");var g=ne(),d=A(g);{var T=m=>{var a=le(),s=u(a,!0);o(a),k(()=>{V(a,"for",e.id),P(s,e.label)}),h(m,a)};M(d,m=>{e.label!=null&&m(T)})}var t=l(d,2);t.__change=[re,_];var i=u(t);i.value=((i.__value="")==null,"");var w=u(i,!0);o(i);var b=l(i);$(b,17,()=>e.items,ee,(m,a)=>{var s=oe(),f={},x=u(s,!0);o(s),k(()=>{f!==(f=v(a).value)&&(s.value=(s.__value=v(a).value)==null?"":v(a).value),P(x,v(a).name)}),h(m,s)}),o(t),k(()=>{V(t,"name",e.name),V(t,"id",e.id),P(w,e.placeHolder)}),h(n,g)}U(["change"]);var me=H('<h2>Đăng kí</h2> <form class="svelte-c6tw1p"><!> <!> <div class="name-input svelte-c6tw1p"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div> <!> <!> <div class="error svelte-c6tw1p"><!></div> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></form> <p class="svelte-c6tw1p">Đã có tài khoản <a href="/login" class="svelte-c6tw1p">Đăng nhập</a></p>',1);function Ne(n,e){Q(e,!0);let _=[{value:"1",name:"Admin"},{value:"2",name:"Manager"},{value:"3",name:"User"}],g=L(!1),d=L(null);async function T(c){c.preventDefault(),N(g,!0);const r=new FormData(c.target),y=await te({email:r.get("email"),lastName:r.get("lastName"),firstName:r.get("firstName"),password:r.get("password"),confirmPassword:r.get("confirmPassword"),roleId:r.get("role")});if(N(g,!1),y.isSuccess)ae.success("Đăng kí thành công"),G("/login");else{let I=y.error;console.log(I.issues),N(d,Z(I.issues[0].message))}}function t(){N(d,null)}var i=me(),w=l(A(i),2),b=u(w);ie(b,{id:"role",items:_,label:"Vai trò",placeHolder:"Chọn vai trò",name:"role"});var m=l(b,2);E(m,{name:"email",id:"email",label:"Email",type:"email",placeHolder:"",onfocus:t});var a=l(m,2),s=u(a);D(s,()=>({"--width":"60%"})),E(s.lastChild,{id:"lastName",name:"lastName",label:"Họ lót",type:"text",placeHolder:"VD: Nguyễn Văn",onfocus:t}),o(s);var f=l(s,2);D(f,()=>({"--width":"40%"})),E(f.lastChild,{id:"firstName",name:"firstName",label:"Tên",type:"text",placeHolder:"VD: An",onfocus:t}),o(f),o(a);var x=l(a,2);z(x,{id:"password",name:"password",label:"Mật khẩu",placeHolder:"",onfocus:t});var j=l(x,2);z(j,{id:"retypePassword",name:"confirmPassword",label:"Nhập lại mật khẩu",placeHolder:"",onfocus:t});var S=l(j,2),X=u(S);{var B=c=>{var r=q();k(()=>P(r,v(d))),h(c,r)};M(X,c=>{v(d)!=null&&c(B)})}o(S);var C=l(S,2);D(C,()=>({"--margin-top":"1em"})),O(C.lastChild,{get isLoading(){return v(g)},children:(c,r)=>{F();var y=q("Đăng kí");h(c,y)},$$slots:{default:!0}}),o(C),o(w),F(2),W("submit",w,T),h(n,i),R()}export{Ne as component};
