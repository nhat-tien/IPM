import"../chunks/disclose-version.Bg9kRutz.js";import{v as M,t as N,a4 as l,a5 as v,a6 as o,j as g,a9 as W,aa as X,a3 as F,ab as y,a1 as q}from"../chunks/runtime.CGf5uJ7Y.js";import{d as G,s as P,e as J}from"../chunks/render.Qv6iRyJ3.js";import{i as B}from"../chunks/if.Ci8_EKmB.js";import{c as C}from"../chunks/css-props.sBKAe1PU.js";import{a as h,t as H,b as z}from"../chunks/template.DrFoD_Dm.js";import{a as K,p as O}from"../chunks/props.CkQrhzFR.js";import{g as Q}from"../chunks/entry.DtVho4PG.js";import{z as u,a as Y,H as Z,P as D}from"../chunks/PrimaryTextField.BGRG2kUX.js";import{P as A,L as $}from"../chunks/PasswordTextField.DhsZp9_g.js";import{T as ee}from"../chunks/TitleWebPage.BrpKPykg.js";import{e as ae,i as se}from"../chunks/each.CTzuMR3Z.js";import{s as E}from"../chunks/attributes.CA0gllOY.js";import{t as te}from"../chunks/Toaster.svelte_svelte_type_style_lang.Cu0oHrnA.js";const re=u.object({roleId:u.enum(["1","2","3"],{message:"Xin hãy chọn vai trò"}),email:u.string().email({message:"Định dạng email chưa đúng"}),lastName:u.string().min(1,{message:"Họ lót không được trống"}).max(50,{message:"Họ lót không vượt quá 50 kí tự"}),firstName:u.string().min(1,{message:"Tên không được trống"}).max(15,{message:"Tên không vượt quá 15 kí tự"}),password:u.string().min(6,{message:"password tối thiểu 6 và tối đa 20 kí tự"}).max(20,{message:"password tối thiểu 6 và tối đa 20 kí tự"}),confirmPassword:u.string()}).refine(({password:n,confirmPassword:e})=>n===e,{message:"Nhập lại mật khẩu chưa chính xác"});async function le(n){try{let e=re.parse(n);return(await Y.post("register",{json:{lastName:e.lastName,firstName:e.firstName,email:e.email,password:e.password,roleId:e.roleId},credentials:"include"}).json()).isSuccess?{isSuccess:!0,error:null}:{isSuccess:!1,error:null}}catch(e){return e instanceof Z&&console.log(await e.response.json()),{isSuccess:!1,error:e}}}function oe(n,e){e(n.currentTarget.value)}var ne=H("<label> </label>"),ie=H("<option> </option>"),me=H('<!> <select class="svelte-1088339"><option disabled selected hidden> </option><!></select>',1);function ce(n,e){let b=K(e,"value",15,"");var f=me(),d=M(f);{var T=m=>{var a=ne(),t=v(a,!0);o(a),N(()=>{E(a,"for",e.id),P(t,e.label)}),h(m,a)};B(d,m=>{e.label!=null&&m(T)})}var s=l(d,2);s.__change=[oe,b];var i=v(s);i.value=((i.__value="")==null,"");var x=v(i,!0);o(i);var w=l(i);ae(w,17,()=>e.items,se,(m,a)=>{var t=ie(),p={},_=v(t,!0);o(t),N(()=>{p!==(p=g(a).value)&&(t.value=(t.__value=g(a).value)==null?"":g(a).value),P(_,g(a).name)}),h(m,t)}),o(s),N(()=>{E(s,"name",e.name),E(s,"id",e.id),P(x,e.placeHolder)}),h(n,f)}G(["change"]);var de=H('<!> <h2>Đăng kí</h2> <form class="svelte-c6tw1p"><!> <!> <div class="name-input svelte-c6tw1p"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div> <!> <!> <div class="error svelte-c6tw1p"><!></div> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></form> <p class="svelte-c6tw1p">Đã có tài khoản <a href="/login" class="svelte-c6tw1p">Đăng nhập</a></p>',1);function He(n,e){W(e,!0);let b=[{value:"1",name:"Admin"},{value:"2",name:"Manager"},{value:"3",name:"User"}],f=F(!1),d=F(null);async function T(c){c.preventDefault(),y(f,!0);const r=new FormData(c.target),k=await le({email:r.get("email"),lastName:r.get("lastName"),firstName:r.get("firstName"),password:r.get("password"),confirmPassword:r.get("confirmPassword"),roleId:r.get("role")});if(y(f,!1),k.isSuccess)te.success("Đăng kí thành công"),Q("/login");else{let V=k.error;console.log(V.issues),y(d,O(V.issues[0].message))}}function s(){y(d,null)}var i=de(),x=M(i);ee(x,{title:"Đăng kí"});var w=l(x,4),m=v(w);ce(m,{id:"role",items:b,label:"Vai trò",placeHolder:"Chọn vai trò",name:"role"});var a=l(m,2);D(a,{name:"email",id:"email",label:"Email",type:"email",placeHolder:"",onfocus:s});var t=l(a,2),p=v(t);C(p,()=>({"--width":"60%"})),D(p.lastChild,{id:"lastName",name:"lastName",label:"Họ lót",type:"text",placeHolder:"VD: Nguyễn Văn",onfocus:s}),o(p);var _=l(p,2);C(_,()=>({"--width":"40%"})),D(_.lastChild,{id:"firstName",name:"firstName",label:"Tên",type:"text",placeHolder:"VD: An",onfocus:s}),o(_),o(t);var I=l(t,2);A(I,{id:"password",name:"password",label:"Mật khẩu",placeHolder:"",onfocus:s});var L=l(I,2);A(L,{id:"retypePassword",name:"confirmPassword",label:"Nhập lại mật khẩu",placeHolder:"",onfocus:s});var S=l(L,2),R=v(S);{var U=c=>{var r=z();N(()=>P(r,g(d))),h(c,r)};B(R,c=>{g(d)!=null&&c(U)})}o(S);var j=l(S,2);C(j,()=>({"--margin-top":"1em"})),$(j.lastChild,{get isLoading(){return g(f)},children:(c,r)=>{q();var k=z("Đăng kí");h(c,k)},$$slots:{default:!0}}),o(j),o(w),q(2),J("submit",w,T),h(n,i),X()}export{He as component};
