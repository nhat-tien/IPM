import{a as h,t as P,b as I}from"../chunks/disclose-version.Bh5S6th3.js";import{a1 as z,R as k,W as l,X as u,Y as o,Z as v,$ as B,a0 as U,_ as N,P as L,V as F}from"../chunks/runtime.lGjdO0kn.js";import{d as W,s as H,e as Y}from"../chunks/render.CqSVrQGm.js";import{i as A}from"../chunks/if.D-X0sUps.js";import{c as D}from"../chunks/css-props.Dz4kt93Y.js";import{a as Z,p as G}from"../chunks/props.BcrW9nJw.js";import{g as J}from"../chunks/entry.Bc1eldB2.js";import{z as p,a as K,H as O,P as E,b as q,L as Q}from"../chunks/PrimaryTextField.K2Un_PVx.js";import{e as $,i as ee}from"../chunks/each.pyYHcR3Z.js";import{s as V}from"../chunks/attributes.BVv3NWUD.js";import{t as ae}from"../chunks/Toaster.svelte_svelte_type_style_lang.Djr9A2tR.js";const se=p.object({roleId:p.enum(["1","2","3"],{message:"Xin hãy chọn vai trò"}),email:p.string().email({message:"Định dạng email chưa đúng"}),lastName:p.string().min(1,{message:"Họ lót không được trống"}).max(50,{message:"Họ lót không vượt quá 50 kí tự"}),firstName:p.string().min(1,{message:"Tên không được trống"}).max(15,{message:"Tên không vượt quá 15 kí tự"}),password:p.string().min(6,{message:"password tối thiểu 6 và tối đa 20 kí tự"}).max(20,{message:"password tối thiểu 6 và tối đa 20 kí tự"}),confirmPassword:p.string()}).refine(({password:n,confirmPassword:e})=>n===e,{message:"Nhập lại mật khẩu chưa chính xác"});async function te(n){try{let e=se.parse(n);return(await K.post("register",{json:{lastName:e.lastName,firstName:e.firstName,email:e.email,password:e.password,roleId:e.roleId},credentials:"include"}).json()).isSuccess?{isSuccess:!0,error:null}:{isSuccess:!1,error:null}}catch(e){return e instanceof O&&console.log(await e.response.json()),{isSuccess:!1,error:e}}}function re(n,e){e(n.currentTarget.value)}var le=P("<label> </label>"),oe=P("<option> </option>"),ne=P('<!> <select class="svelte-1088339"><option disabled selected hidden> </option><!></select>',1);function ie(n,e){let b=Z(e,"value",15,"");var g=ne(),d=z(g);{var S=m=>{var a=le(),s=u(a,!0);o(a),k(()=>{V(a,"for",e.id),H(s,e.label)}),h(m,a)};A(d,m=>{e.label!=null&&m(S)})}var t=l(d,2);t.__change=[re,b];var i=u(t);i.value=((i.__value="")==null,"");var w=u(i,!0);o(i);var x=l(i);$(x,17,()=>e.items,ee,(m,a)=>{var s=oe(),f={},y=u(s,!0);o(s),k(()=>{f!==(f=v(a).value)&&(s.value=(s.__value=v(a).value)==null?"":v(a).value),H(y,v(a).name)}),h(m,s)}),o(t),k(()=>{V(t,"name",e.name),V(t,"id",e.id),H(w,e.placeHolder)}),h(n,g)}W(["change"]);var me=P('<h2>Đăng kí</h2> <form class="svelte-c6tw1p"><!> <!> <div class="name-input svelte-c6tw1p"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div> <!> <!> <div class="error svelte-c6tw1p"><!></div> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></form> <p class="svelte-c6tw1p">Đã có tài khoản <a href="/login" class="svelte-c6tw1p">Đăng nhập</a></p>',1);function xe(n,e){B(e,!0);let b=[{value:"1",name:"Admin"},{value:"2",name:"Manager"},{value:"3",name:"User"}],g=F(!1),d=F(null);async function S(c){c.preventDefault(),N(g,!0);const r=new FormData(c.target),_=await te({email:r.get("email"),lastName:r.get("lastName"),firstName:r.get("firstName"),password:r.get("password"),confirmPassword:r.get("confirmPassword"),roleId:r.get("role")});if(N(g,!1),_.isSuccess)ae.success("Đăng kí thành công"),J("/login");else{console.log(_.error);let X=_.error;N(d,G(X.issues[0].message))}}function t(){N(d,null)}var i=me(),w=l(z(i),2),x=u(w);ie(x,{id:"role",items:b,label:"Vai trò",placeHolder:"Chọn vai trò",name:"role"});var m=l(x,2);E(m,{name:"email",id:"email",label:"Email",type:"email",placeHolder:"",onfocus:t});var a=l(m,2),s=u(a);D(s,()=>({"--width":"60%"})),E(s.lastChild,{id:"lastName",name:"lastName",label:"Họ lót",type:"text",placeHolder:"VD: Nguyễn Văn",onfocus:t}),o(s);var f=l(s,2);D(f,()=>({"--width":"40%"})),E(f.lastChild,{id:"firstName",name:"firstName",label:"Tên",type:"text",placeHolder:"VD: An",onfocus:t}),o(f),o(a);var y=l(a,2);q(y,{id:"password",name:"password",label:"Mật khẩu",placeHolder:"",onfocus:t});var j=l(y,2);q(j,{id:"retypePassword",name:"confirmPassword",label:"Nhập lại mật khẩu",placeHolder:"",onfocus:t});var T=l(j,2),M=u(T);{var R=c=>{var r=I();k(()=>H(r,v(d))),h(c,r)};A(M,c=>{v(d)!=null&&c(R)})}o(T);var C=l(T,2);D(C,()=>({"--margin-top":"1em"})),Q(C.lastChild,{get isLoading(){return v(g)},children:(c,r)=>{L();var _=I("Đăng kí");h(c,_)},$$slots:{default:!0}}),o(C),o(w),L(2),Y("submit",w,S),h(n,i),U()}export{xe as component};
