import"../chunks/disclose-version.Bg9kRutz.js";import{a2 as L,V as l,a4 as $,a3 as z,W as b,Y as d,T as k,Z as i,X as u,Q as F,P as x}from"../chunks/runtime.2TQkkbdU.js";import{e as U,s as j}from"../chunks/render.CUPvWneb.js";import{i as D}from"../chunks/if.7ZJsWVon.js";import{c as H}from"../chunks/css-props.BPPcTq2y.js";import{a as f,t as W,b as _}from"../chunks/template.CAbfWL_E.js";import{p as q}from"../chunks/props.BH3iTQOK.js";import{g as B}from"../chunks/entry.DQpy8rRy.js";import{z as g,a as C,H as I,P as Q}from"../chunks/PrimaryTextField.t_Uysw41.js";import{s as A}from"../chunks/jwtService.BpeZ_aWj.js";import{s as J,d as V}from"../chunks/userInfo.svelte.tpW4U4XW.js";import{P as X,L as Y}from"../chunks/PasswordTextField.lcDNlKNj.js";import{t as Z}from"../chunks/Toaster.svelte_svelte_type_style_lang.Ca3an25N.js";const G=g.object({email:g.string().email({message:"Định dạng email chưa đúng"}),password:g.string()});async function K(m){try{let s=G.parse(m);const a=await C.post("login",{json:{email:s.email,password:s.password},credentials:"include"}).json();return J(V(a.accessToken)),A(a.accessToken),{isSuccess:!0,error:null}}catch(s){return s instanceof I&&s.response.status==401?{isSuccess:!1,error:"Unauthorized"}:{isSuccess:!1,error:s}}}var M=W('<h1 class="svelte-11mappv">Welcome Back</h1> <form class="svelte-11mappv"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!> <a class="forgot-password svelte-11mappv" href="/">Quên mật khẩu</a> <div class="error svelte-11mappv"><!></div> <!></form> <p class="register svelte-11mappv">Chưa có tài khoản? <a href="/register" class="svelte-11mappv">Đăng kí</a></p>',1);function ps(m,s){L(s,!0);let a=k(!1),t=k(null);async function y(e){e.preventDefault(),i(a,!0);const r=new FormData(e.target),o=await K({email:r.get("email"),password:r.get("password")});if(i(a,!1),o.isSuccess)Z.success("Đăng nhập thành công"),B("/dashboard");else if(o.error==="Unauthorized")i(t,"Email hoặc mật khẩu không chính xác");else{let S=o.error;i(t,q(S.issues[0].message))}}function v(){i(t,null)}var h=M(),p=l($(h),2),n=b(p);H(n,()=>({"--margin-bottom":"1.5em"})),Q(n.lastChild,{id:"email",placeHolder:"anh@gmail.com",label:"Email",type:"email",name:"email",onfocus:v,required:!0}),u(n);var w=l(n,2);X(w,{id:"password",label:"Password",name:"password",onfocus:v,required:!0});var c=l(w,4),P=b(c);{var T=e=>{var r=_();F(()=>j(r,d(t))),f(e,r)};D(P,e=>{d(t)!=null&&e(T)})}u(c);var E=l(c,2);Y(E,{get isLoading(){return d(a)},type:"submit",children:(e,r)=>{x();var o=_("Đăng nhập");f(e,o)},$$slots:{default:!0}}),u(p),x(2),U("submit",p,y),f(m,h),z()}export{ps as component};
